<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸€æ®µè€ƒå¾Œï¼ç†åŒ–å¿ƒè£¡è©±</title>
  
  <!-- å¼•å…¥ React å’Œ Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- å¼•å…¥ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- å¼•å…¥ Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@400;500&family=Nunito:wght@600;800&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Kiwi Maru', serif;
      background-color: #FFF9F2;
    }
    .font-heading {
      font-family: 'Nunito', sans-serif;
    }
    
    /* è‡ªå®šç¾©æ²è»¸ */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #FFF9F2; 
    }
    ::-webkit-scrollbar-thumb {
      background: #FDBA74; 
      border-radius: 10px;
    }

    /* ç¯„åœæ»‘æ¡¿æ¨£å¼å„ªåŒ– */
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: #F97316;
      cursor: pointer;
      margin-top: -6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    }
    input[type=range]::-webkit-slider-runnable-track {
      width: 100%;
      height: 8px;
      cursor: pointer;
      background: #FED7AA;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- åœ–ç¤ºçµ„ä»¶ (SVG) ---
    const IconWrapper = ({ children, className }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        {children}
      </svg>
    );

    const Icons = {
      Send: (props) => <IconWrapper {...props}><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></IconWrapper>,
      Loader2: (props) => <IconWrapper {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></IconWrapper>,
      AlertCircle: (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></IconWrapper>,
      Heart: (props) => <IconWrapper {...props}><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></IconWrapper>,
      Sun: (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></IconWrapper>,
      Sprout: (props) => <IconWrapper {...props}><path d="M7 20h10"></path><path d="M10 20c5.5-2.5.8-6.4 3-10"></path><path d="M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.2.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z"></path><path d="M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1.7-1.3 2.9-4 3.1-6.2-2 .9-4 1.8-6.3 3.6z"></path></IconWrapper>,
      Coffee: (props) => <IconWrapper {...props}><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></IconWrapper>,
      BookOpen: (props) => <IconWrapper {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></IconWrapper>,
      Smile: (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></IconWrapper>,
      Frown: (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"></circle><path d="M16 16s-1.5-2-4-2-4 2-4 2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></IconWrapper>,
      Target: (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></IconWrapper>,
      Feather: (props) => <IconWrapper {...props}><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></IconWrapper>,
      Sparkles: (props) => <IconWrapper {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path></IconWrapper>,
      Brain: (props) => <IconWrapper {...props}><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></IconWrapper>,
      Lightbulb: (props) => <IconWrapper {...props}><line x1="9" y1="18" x2="15" y2="18"></line><line x1="10" y1="22" x2="14" y2="22"></line><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 9.5 6 4.65 4.65 0 0 0 2.5 11.5c0 1.07.46 2.07 1.41 2.5.76.76 1.23 1.52 1.41 2.5"></path></IconWrapper>
    };

    // --- æº«é¦¨æ’åœ–çµ„ä»¶ ---
    const SunIllustration = () => (
      <svg viewBox="0 0 200 120" className="w-full h-32 md:h-40 mx-auto mb-4">
        <circle cx="100" cy="100" r="40" fill="#FDBA74" className="animate-pulse" opacity="0.8" />
        <circle cx="100" cy="100" r="25" fill="#F97316" />
        <path d="M40 100 Q70 70 100 100 T160 100" fill="none" stroke="#FFF7ED" strokeWidth="4" strokeLinecap="round" />
        <circle cx="150" cy="40" r="15" fill="#FFF7ED" opacity="0.6" />
        <circle cx="165" cy="50" r="20" fill="#FFF7ED" opacity="0.6" />
      </svg>
    );

    const LetterIllustration = () => (
      <svg viewBox="0 0 200 150" className="w-48 h-48 mx-auto mb-6">
        <rect x="40" y="40" width="120" height="80" rx="10" fill="#FFF" stroke="#FB923C" strokeWidth="3"/>
        <path d="M40 40 L100 90 L160 40" fill="none" stroke="#FB923C" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"/>
        <circle cx="100" cy="90" r="18" fill="#F43F5E" />
        <path d="M92 92 L100 100 L108 84" fill="none" stroke="white" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"/>
        <g className="animate-bounce">
           <path d="M100 20 L100 30" stroke="#FDBA74" strokeWidth="3" strokeLinecap="round"/>
           <path d="M80 25 L85 32" stroke="#FDBA74" strokeWidth="3" strokeLinecap="round"/>
           <path d="M120 25 L115 32" stroke="#FDBA74" strokeWidth="3" strokeLinecap="round"/>
        </g>
      </svg>
    );

    // --- ç†è«–å°å¡çµ„ä»¶ ---
    const InsightCard = ({ title, icon: Icon, colorClass, theory, description }) => (
      <div className={`bg-white rounded-2xl p-6 border-l-4 ${colorClass} shadow-sm hover:shadow-md transition-all`}>
        <div className="flex items-start gap-4">
          <div className={`p-3 rounded-xl ${colorClass.replace('border-', 'bg-').replace('500', '100')} text-stone-600`}>
            <Icon className="w-6 h-6" />
          </div>
          <div>
            <h3 className="font-bold text-lg text-stone-700 mb-1">{title}</h3>
            <span className="text-xs font-bold uppercase tracking-wider text-stone-400 mb-2 block">{theory}</span>
            <p className="text-stone-600 text-sm leading-relaxed">{description}</p>
          </div>
        </div>
      </div>
    );

    // --- ä¸»ç¨‹å¼ ---
    function ExamReflectionApp() {
      // â–¼â–¼â–¼ è«‹åœ¨é€™è£¡å¡«å…¥æ‚¨çš„ Google Apps Script ç¶²å€ â–¼â–¼â–¼
      const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzWArfv4aozRGagp285MsrZFUEbxmZj3dhJKpZZFmqv3UTA5B6Wpf1v5BqjVb8B3kz29w/exec";
      // â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²

      const [loading, setLoading] = useState(false);
      const [submitted, setSubmitted] = useState(false);
      const [aiResponse, setAiResponse] = useState(null);
      const [error, setError] = useState("");

      const [formData, setFormData] = useState({
        name: "",
        score: 5,
        emotions: [],
        emotionMessage: "",
        effortLevel: "medium",
        satisfactionLevel: "medium",
        motivation: "",
        errors: {
          external_scope: 0,
          external_confusing: 0,
          external_wrong_key: 0,
          internal_careless: 0,
          internal_concept: 0,
          internal_misread: 0,
          internal_template: 0,
          internal_forgot: 0,
          internal_other: 0
        },
        strategyPlus1: "",
        strategyPlus2: "",
        strategyMinus1: ""
      });

      const emotionsList = [
        { label: "ç·Šå¼µ", icon: "ğŸ˜£" }, { label: "å¤±æœ›", icon: "ğŸ˜" }, 
        { label: "ç”Ÿæ°£", icon: "ğŸ˜¡" }, { label: "ç¾æ„§", icon: "ğŸ˜³" }, 
        { label: "ç–²æ†Š", icon: "ğŸ˜«" }, { label: "èˆ’é©", icon: "ğŸ˜Œ" }, 
        { label: "é©•å‚²", icon: "ğŸ˜¤" }, { label: "æœ‰è¶£", icon: "ğŸ¤©" }, 
        { label: "é¬†ä¸€å£æ°£", icon: "ğŸ˜®â€ğŸ’¨" }
      ];

      const handleInputChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
      };

      const handleErrorCountChange = (key, value) => {
        setFormData(prev => ({
          ...prev,
          errors: { ...prev.errors, [key]: parseInt(value) || 0 }
        }));
      };

      const toggleEmotion = (emotionLabel) => {
        setFormData(prev => {
          const current = prev.emotions;
          if (current.includes(emotionLabel)) {
            return { ...prev, emotions: current.filter(e => e !== emotionLabel) };
          } else {
            return { ...prev, emotions: [...current, emotionLabel] };
          }
        });
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (GAS_WEB_APP_URL.includes("è«‹åœ¨æ­¤å¡«å…¥")) {
            setError("è€å¸«é‚„æ²’è¨­å®šå¥½é€£çµç¶²å€å–”ï¼è«‹æé†’è€å¸«è¨­å®šã€‚");
            return;
        }

        setLoading(true);
        setError("");

        try {
          const response = await fetch(GAS_WEB_APP_URL, {
            method: "POST",
            body: JSON.stringify(formData)
          });

          const data = await response.json();

          if (data.status === 'success') {
            setSubmitted(true);
            setAiResponse(data.aiAnalysis);
            window.scrollTo({ top: 0, behavior: 'smooth' });
          } else {
            throw new Error(data.message || "ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤");
          }
        } catch (err) {
          console.error(err);
          setError("é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯ç‹€æ³ï¼Œå†è©¦ä¸€æ¬¡çœ‹çœ‹ï¼");
        } finally {
          setLoading(false);
        }
      };

      // --- çµæœé¡¯ç¤ºé é¢ ---
      if (submitted && aiResponse) {
        return (
          <div className="min-h-screen bg-[#FFF9F2] p-4 md:p-8 font-sans flex justify-center items-start">
            <div className="max-w-4xl w-full space-y-8">
              
              {/* å¡ç‰‡ 1: AI å›ä¿¡ */}
              <div className="bg-white rounded-[2rem] shadow-xl border-4 border-orange-100 overflow-hidden">
                <div className="bg-gradient-to-b from-orange-50 to-white p-8 text-center">
                  <LetterIllustration />
                  <h1 className="text-3xl font-bold text-orange-800 mb-2 tracking-wide">
                    AI è€å¸«çš„å›ä¿¡
                  </h1>
                  <p className="text-orange-600 font-medium bg-orange-100 inline-block px-4 py-1 rounded-full">
                    çµ¦è¦ªæ„›çš„ {formData.name}
                  </p>
                </div>
                
                <div className="p-8 pt-0 space-y-8">
                  <div className="bg-orange-50/50 p-8 rounded-3xl border border-orange-100 relative">
                    <div className="absolute -top-4 left-6 bg-white px-4 py-1.5 rounded-full text-orange-500 font-bold text-sm shadow-sm border border-orange-100 flex items-center gap-2">
                      <Icons.Sparkles className="w-4 h-4" /> å°ˆå±¬åˆ†æèˆ‡å»ºè­°
                    </div>
                    <div className="prose prose-orange max-w-none whitespace-pre-line text-stone-600 leading-8 text-lg font-medium">
                      {aiResponse}
                    </div>
                  </div>
                </div>
              </div>

              {/* å¡ç‰‡ 2: æ•™è‚²å­¸ç†ä¾æ“š (æ–°å¢çš„éƒ¨åˆ†) */}
              <div className="bg-[#FFF9F2]">
                <div className="flex items-center gap-3 mb-6 px-4">
                  <Icons.Brain className="w-8 h-8 text-stone-400" />
                  <h2 className="text-2xl font-bold text-stone-600">é€™ä¸€åˆ»ï¼Œå¤§è…¦ç™¼ç”Ÿäº†ä»€éº¼äº‹ï¼Ÿ</h2>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <InsightCard 
                    title="ç‚ºä»€éº¼è¦å•æƒ…ç·’ï¼Ÿ" 
                    icon={Icons.Heart}
                    colorClass="border-rose-400"
                    theory="æƒ…ç·’åŠŸèƒ½è«– (Functionalist Theory)"
                    description="æƒ…ç·’ä¸æ˜¯é›œè¨Šï¼Œè€Œæ˜¯å¤§è…¦çµ¦ä½ çš„é‡è¦æƒ…å ±ã€‚ä¾‹å¦‚ã€Œç„¦æ…®ã€å¸¸ä»£è¡¨æº–å‚™ä¸è¶³ï¼›ã€Œç”Ÿæ°£ã€å¯èƒ½ä»£è¡¨é‡åˆ°é˜»ç¤™ã€‚å¯«ä¸‹ä¾†ï¼Œèƒ½å°‡é€™äº›è¨Šè™Ÿè½‰åŒ–ç‚ºè¡Œå‹•åŠ›ã€‚"
                  />
                  <InsightCard 
                    title="åŠªåŠ› vs çµæœçš„ç§˜å¯†" 
                    icon={Icons.Target}
                    colorClass="border-amber-400"
                    theory="æ­¸å› ç†è«– (Attribution Theory)"
                    description="å¿ƒç†å­¸å®¶ Weiner ç™¼ç¾ï¼Œå°‡æˆæ•—æ­¸å› æ–¼ã€Œå¯æ§åˆ¶å› ç´ ã€ï¼ˆå¦‚ï¼šåŠªåŠ›æ–¹æ³•ï¼‰è€Œéã€Œä¸å¯æ§å› ç´ ã€ï¼ˆå¦‚ï¼šé‹æ°£å¤©è³¦ï¼‰ï¼Œæ˜¯å»ºç«‹æˆé•·å‹æ€ç¶­çš„é—œéµã€‚"
                  />
                  <InsightCard 
                    title="ç‚ºä»€éº¼è¦åˆ†æå‹•æ©Ÿï¼Ÿ" 
                    icon={Icons.Lightbulb}
                    colorClass="border-blue-400"
                    theory="è‡ªæˆ‘æ±ºå®šè«– (Self-Determination Theory)"
                    description="é‡æ¸…æ˜¯ç‚ºäº†ã€Œå¤–åœ¨çè³ã€é‚„æ˜¯ã€Œå…§åœ¨èˆˆè¶£ã€è®€æ›¸å¾ˆé‡è¦ã€‚å…§åœ¨å‹•æ©Ÿï¼ˆè¦ºå¾—æœ‰è¶£ã€æœ‰æ„ç¾©ï¼‰èƒ½å¸¶ä¾†æ›´é•·ä¹…çš„å­¸ç¿’çºŒèˆªåŠ›ã€‚"
                  />
                  <InsightCard 
                    title="éŒ¯é¡Œåˆ†æèˆ‡ç­–ç•¥" 
                    icon={Icons.Sprout}
                    colorClass="border-green-400"
                    theory="å¾Œè¨­èªçŸ¥ (Metacognition)"
                    description="å„ªç§€çš„å­¸ç¿’è€…ä¸åªæœƒã€Œå­¸ã€ï¼Œé‚„æœƒã€Œç›£æ§è‡ªå·±æ€éº¼å­¸ã€ã€‚åˆ†ææ˜¯ç²—å¿ƒé‚„æ˜¯æ¦‚å¿µä¸æ¸…ï¼Œå°±æ˜¯åœ¨å¤§è…¦ä¸­å»ºç«‹æª¢æŸ¥æ©Ÿåˆ¶ï¼Œé¿å…ä¸‹æ¬¡çŠ¯åŒæ¨£çš„éŒ¯ã€‚"
                  />
                </div>
              </div>

              {/* åº•éƒ¨æŒ‰éˆ• */}
              <div className="text-center pb-8 pt-4">
                <button 
                  onClick={() => {
                      setSubmitted(false);
                      setAiResponse(null);
                      setFormData({...formData, name: ""});
                      window.scrollTo({ top: 0, behavior: 'smooth' });
                  }}
                  className="group px-8 py-3 bg-stone-700 hover:bg-stone-800 text-white rounded-full font-bold transition-all transform hover:scale-105 shadow-lg active:scale-95 flex items-center gap-2 mx-auto"
                >
                  <Icons.Feather className="w-4 h-4 group-hover:rotate-12 transition-transform"/>
                  å¡«å¯«ä¸‹ä¸€ä»½
                </button>
              </div>

            </div>
          </div>
        );
      }

      // --- è¡¨å–®å¡«å¯«é é¢ ---
      return (
        <div className="min-h-screen bg-[#FFF9F2] py-10 px-4 font-sans text-stone-600">
          <div className="max-w-2xl mx-auto">
            
            {/* Header Card */}
            <div className="bg-white rounded-[2.5rem] p-8 shadow-xl border-b-8 border-orange-200 mb-8 text-center relative overflow-hidden">
              <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-orange-300 via-rose-300 to-amber-300"></div>
              <SunIllustration />
              <h1 className="text-3xl font-bold text-stone-700 tracking-wide mb-2">
                ä¸€æ®µè€ƒå¾Œï¼ç†åŒ–å¿ƒè£¡è©±
              </h1>
              <p className="text-stone-500 text-lg flex items-center justify-center gap-2">
                <Icons.Coffee className="w-5 h-5 text-orange-400" />
                æ‰¾å€‹èˆ’æœçš„æ™‚é–“ï¼Œèª å¯¦é¢å°è‡ªå·±
              </p>
            </div>

            <form onSubmit={handleSubmit} className="space-y-6">
              
              {/* Section 1: é—œæ–¼ä½  */}
              <div className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-orange-50 hover:shadow-md transition-shadow">
                <div className="flex items-center gap-3 mb-6">
                  <div className="bg-orange-100 p-2.5 rounded-2xl text-orange-500">
                    <Icons.Smile className="w-6 h-6" />
                  </div>
                  <h2 className="text-xl font-bold text-stone-700">é—œæ–¼ä½ </h2>
                </div>
                
                <div className="space-y-6">
                  <div>
                    <label className="block text-stone-600 font-bold mb-2 ml-1">ä½ çš„åå­—</label>
                    <input 
                      required
                      type="text" 
                      name="name"
                      value={formData.name}
                      onChange={handleInputChange}
                      className="w-full bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-orange-300 focus:ring-0 px-4 py-3 text-lg outline-none transition-colors placeholder-stone-300"
                      placeholder="è«‹è¼¸å…¥å§“å"
                    />
                  </div>

                  <div>
                    <label className="block text-stone-600 font-bold mb-3 ml-1">é€™æ¬¡è¡¨ç¾æ»¿æ„åº¦ (1~10åˆ†)</label>
                    <div className="bg-stone-50 rounded-3xl p-6 border-2 border-stone-100">
                      <div className="flex items-center gap-4 mb-2">
                        <span className="text-sm font-bold text-stone-400">1</span>
                        <input 
                          type="range" 
                          min="1" 
                          max="10" 
                          name="score"
                          value={formData.score}
                          onChange={handleInputChange}
                          className="w-full h-3 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-orange-500"
                        />
                        <span className="text-sm font-bold text-stone-400">10</span>
                      </div>
                      <div className="flex justify-center mt-2">
                        <span className="bg-white text-orange-500 px-6 py-1.5 rounded-full text-xl font-bold shadow-sm border border-orange-100">
                          {formData.score} åˆ†
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              {/* Section 2: æƒ…ç·’è¦ºå¯Ÿ */}
              <div className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-orange-50 hover:shadow-md transition-shadow">
                <div className="flex items-center gap-3 mb-6">
                  <div className="bg-rose-100 p-2.5 rounded-2xl text-rose-500">
                    <Icons.Heart className="w-6 h-6" />
                  </div>
                  <h2 className="text-xl font-bold text-stone-700">æƒ…ç·’æƒæ</h2>
                </div>

                <p className="mb-4 text-stone-500 ml-1">çœ‹è‘—è€ƒå·ï¼Œç•¶ä¸‹æœ€å¼·çƒˆçš„æ„Ÿè¦ºæ˜¯ï¼Ÿ(å¯å¤šé¸)</p>
                <div className="flex flex-wrap gap-3 mb-6">
                  {emotionsList.map(emotion => (
                    <button
                      key={emotion.label}
                      type="button"
                      onClick={() => toggleEmotion(emotion.label)}
                      className={`px-4 py-3 rounded-2xl text-base font-bold transition-all duration-200 border-2 flex items-center gap-2 ${
                        formData.emotions.includes(emotion.label)
                          ? 'bg-rose-400 border-rose-400 text-white shadow-md transform -translate-y-1'
                          : 'bg-white border-stone-100 text-stone-500 hover:border-rose-200 hover:bg-rose-50'
                      }`}
                    >
                      <span className="text-lg">{emotion.icon}</span>
                      {emotion.label}
                    </button>
                  ))}
                </div>
                
                <div className="relative">
                  <div className="absolute -top-3 left-3 bg-white px-2 text-xs text-rose-400 font-bold">æˆ‘æƒ³... æƒ…ç·’æƒ³æé†’æˆ‘çš„è¨Šæ¯æ˜¯</div>
                  <textarea 
                    name="emotionMessage"
                    value={formData.emotionMessage}
                    onChange={handleInputChange}
                    rows="2"
                    className="w-full bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-rose-300 focus:ring-0 px-4 py-4 text-base outline-none transition-colors resize-none placeholder-stone-300"
                    placeholder="ä¾‹å¦‚ï¼šé›–ç„¶æœ‰é»å¤±æœ›ï¼Œä½†é€™ä»£è¡¨æˆ‘å…¶å¯¦å¾ˆåœ¨ä¹..."
                  />
                </div>
              </div>

              {/* Section 3: å®šä½èˆ‡å‹•æ©Ÿ */}
              <div className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-orange-50 hover:shadow-md transition-shadow">
                <div className="flex items-center gap-3 mb-6">
                  <div className="bg-amber-100 p-2.5 rounded-2xl text-amber-500">
                    <Icons.Target className="w-6 h-6" />
                  </div>
                  <h2 className="text-xl font-bold text-stone-700">å®šä½èˆ‡å‹•æ©Ÿ</h2>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                  <div className="bg-amber-50 p-4 rounded-3xl">
                    <label className="block text-sm font-bold text-amber-800 mb-2">æº–å‚™éç¨‹åŠªåŠ›ç¨‹åº¦</label>
                    <select 
                      name="effortLevel" 
                      value={formData.effortLevel} 
                      onChange={handleInputChange}
                      className="w-full bg-white border-0 text-stone-700 py-3 px-4 rounded-xl focus:ring-2 focus:ring-amber-200 shadow-sm cursor-pointer"
                    >
                      <option value="low">â˜ï¸ åŠªåŠ›ä¸è¶³</option>
                      <option value="medium">ğŸŒ± æ™®é€šå°šå¯</option>
                      <option value="high">ğŸŒ³ æº–å‚™å……åˆ†</option>
                    </select>
                  </div>
                  <div className="bg-amber-50 p-4 rounded-3xl">
                    <label className="block text-sm font-bold text-amber-800 mb-2">å°çµæœæ»¿æ„ç¨‹åº¦</label>
                    <select 
                      name="satisfactionLevel" 
                      value={formData.satisfactionLevel} 
                      onChange={handleInputChange}
                      className="w-full bg-white border-0 text-stone-700 py-3 px-4 rounded-xl focus:ring-2 focus:ring-amber-200 shadow-sm cursor-pointer"
                    >
                      <option value="low">â›ˆï¸ çµæœä¸æ»¿æ„</option>
                      <option value="medium">ğŸŒ¥ï¸ å°šå¯æ¥å—</option>
                      <option value="high">â˜€ï¸ çµæœæ»¿æ„</option>
                    </select>
                  </div>
                </div>

                <div className="relative pt-2">
                  <label className="block text-stone-600 font-bold mb-2 ml-1">æœ€æ ¸å¿ƒçš„è®€æ›¸å‹•æ©Ÿæ˜¯ï¼Ÿ</label>
                  <input 
                    type="text" 
                    name="motivation"
                    value={formData.motivation}
                    onChange={handleInputChange}
                    className="w-full bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-amber-300 focus:ring-0 px-4 py-3 text-base outline-none transition-colors placeholder-stone-300"
                    placeholder="ä¾‹å¦‚ï¼šä¸æƒ³è¼¸çµ¦èª°ã€ç‚ºäº†çå­¸é‡‘ã€å–®ç´”è¦ºå¾—æœ‰è¶£..."
                  />
                </div>
              </div>

              {/* Section 4: éŒ¯èª¤åˆ†æ */}
              <div className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-orange-50 hover:shadow-md transition-shadow">
                 <div className="flex items-center gap-3 mb-6">
                  <div className="bg-red-100 p-2.5 rounded-2xl text-red-500">
                    <Icons.Frown className="w-6 h-6" />
                  </div>
                  <h2 className="text-xl font-bold text-stone-700">ç‚ºä»€éº¼å¤±åˆ†ï¼Ÿ</h2>
                </div>
                <p className="text-stone-500 mb-6 ml-1 text-sm">èª å¯¦è¨˜éŒ„éŒ¯é¡Œæ•¸ï¼Œæ•¸æ“šæœƒå¹«æˆ‘å€‘æ‰¾åˆ°ç›²é»ï¼š</p>
                
                <div className="space-y-6">
                  {/* å¤–åœ¨æ­¸å›  */}
                  <div className="bg-stone-50/80 p-5 rounded-3xl">
                    <h3 className="font-bold text-stone-400 text-sm mb-3 uppercase tracking-wider pl-1">å¤–éƒ¨å› ç´ </h3>
                    <div className="space-y-3">
                      {[
                        { k: 'external_scope', l: 'è¶…å‡ºç¯„åœ' },
                        { k: 'external_confusing', l: 'é¡Œæ„ä¸æ¸…' },
                        { k: 'external_wrong_key', l: 'ç­”æ¡ˆæœ‰èª¤' }
                      ].map(item => (
                        <div key={item.k} className="flex items-center justify-between bg-white p-2 pl-4 rounded-2xl border border-stone-100">
                          <span className="text-stone-600 font-medium">{item.l}</span>
                          <div className="flex items-center gap-2">
                            <input 
                              type="number" 
                              min="0"
                              value={formData.errors[item.k] === 0 ? '' : formData.errors[item.k]}
                              placeholder="0"
                              onChange={(e) => handleErrorCountChange(item.k, e.target.value)}
                              className="w-14 h-10 text-center bg-stone-100 rounded-xl focus:bg-orange-50 focus:ring-2 focus:ring-orange-200 outline-none font-bold text-lg text-stone-700 transition-all placeholder-stone-300"
                            />
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* å…§åœ¨æ­¸å›  */}
                  <div className="bg-red-50/50 p-5 rounded-3xl border border-red-100">
                    <h3 className="font-bold text-red-400 text-sm mb-3 uppercase tracking-wider pl-1">å…§éƒ¨å› ç´  (é—œéµ!)</h3>
                    <div className="grid grid-cols-1 gap-3">
                       {[
                        { k: 'internal_careless', l: 'ğŸ‘€ ç²—å¿ƒ (æŠ„éŒ¯/å–®ä½)' },
                        { k: 'internal_concept', l: 'ğŸ§  æ¦‚å¿µä¸æ¸… (å®šç¾©)' },
                        { k: 'internal_misread', l: 'ğŸ“– è®€éŒ¯é¡Œæ„' },
                        { k: 'internal_template', l: 'ğŸ¤– ä¾è³´æ¨¡æ¿ (è®Šé¡Œä¸æœƒ)' },
                        { k: 'internal_forgot', l: 'ğŸŒ«ï¸ å¿˜è¨˜å…¬å¼/å…§å®¹' },
                        { k: 'internal_other', l: 'ğŸ¤· å…¶ä»–åŸå› ' }
                      ].map(item => (
                        <div key={item.k} className="flex items-center justify-between bg-white p-2 pl-4 rounded-2xl border border-red-50 shadow-sm">
                          <span className="text-stone-700 font-medium">{item.l}</span>
                          <input 
                            type="number" 
                            min="0"
                             value={formData.errors[item.k] === 0 ? '' : formData.errors[item.k]}
                            placeholder="0"
                            onChange={(e) => handleErrorCountChange(item.k, e.target.value)}
                            className="w-14 h-10 text-center bg-red-50 rounded-xl focus:bg-white focus:ring-2 focus:ring-red-200 outline-none font-bold text-lg text-red-800 transition-all placeholder-red-200"
                          />
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>

              {/* Section 5: ç­–ç•¥ */}
              <div className="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-orange-50 hover:shadow-md transition-shadow">
                <div className="flex items-center gap-3 mb-6">
                  <div className="bg-green-100 p-2.5 rounded-2xl text-green-600">
                    <Icons.Sprout className="w-6 h-6" />
                  </div>
                  <h2 className="text-xl font-bold text-stone-700">ä¸‹ä¸€æ­¥è¡Œå‹• (2åŠ 1æ¸›)</h2>
                </div>
                
                <div className="space-y-4">
                  <div className="group flex items-start gap-3">
                    <div className="bg-green-100 text-green-700 w-10 h-10 rounded-2xl flex items-center justify-center font-bold flex-shrink-0 mt-1 shadow-sm group-hover:bg-green-200 transition-colors">+</div>
                    <input 
                      type="text"
                      name="strategyPlus1"
                      value={formData.strategyPlus1}
                      onChange={handleInputChange}
                      placeholder="æˆ‘è¦å¢åŠ çš„å¥½ç¿’æ…£..."
                      className="flex-1 bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-green-300 px-4 py-3 outline-none placeholder-stone-300"
                    />
                  </div>
                  <div className="group flex items-start gap-3">
                    <div className="bg-green-100 text-green-700 w-10 h-10 rounded-2xl flex items-center justify-center font-bold flex-shrink-0 mt-1 shadow-sm group-hover:bg-green-200 transition-colors">+</div>
                    <input 
                      type="text"
                      name="strategyPlus2"
                      value={formData.strategyPlus2}
                      onChange={handleInputChange}
                      placeholder="æˆ‘è¦å˜—è©¦çš„æ–°æ–¹æ³•..."
                      className="flex-1 bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-green-300 px-4 py-3 outline-none placeholder-stone-300"
                    />
                  </div>
                  <div className="group flex items-start gap-3">
                    <div className="bg-red-100 text-red-700 w-10 h-10 rounded-2xl flex items-center justify-center font-bold flex-shrink-0 mt-1 shadow-sm group-hover:bg-red-200 transition-colors">-</div>
                    <input 
                      type="text"
                      name="strategyMinus1"
                      value={formData.strategyMinus1}
                      onChange={handleInputChange}
                      placeholder="æˆ‘è¦åœæ­¢çš„å£ç¿’æ…£..."
                      className="flex-1 bg-stone-50 rounded-2xl border-2 border-stone-100 focus:border-red-300 px-4 py-3 outline-none placeholder-stone-300"
                    />
                  </div>
                </div>
              </div>

              {/* Submit */}
              <div className="pt-6 pb-12">
                {error && (
                  <div className="mb-6 p-4 bg-red-100 text-red-600 rounded-2xl text-center font-bold animate-pulse flex items-center justify-center gap-2">
                    <Icons.AlertCircle className="w-5 h-5"/> {error}
                  </div>
                )}
                
                <button
                  type="submit"
                  disabled={loading}
                  className={`w-full py-4 rounded-full text-white font-bold text-xl shadow-[0_6px_0_rgb(234,88,12)] active:shadow-none active:translate-y-[6px] transition-all flex items-center justify-center gap-2 ${
                    loading 
                      ? 'bg-stone-300 shadow-none cursor-not-allowed' 
                      : 'bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600'
                  }`}
                >
                  {loading ? (
                    <>
                      <Icons.Loader2 className="w-6 h-6 animate-spin" />
                      ç”¨å¿ƒè†è½ä¸­...
                    </>
                  ) : (
                    <>
                      <Icons.Send className="w-5 h-5" />
                      é€å‡ºå¿ƒè£¡è©±ï¼Œè½è½ AI æ€éº¼èªª
                    </>
                  )}
                </button>
                <div className="text-center mt-6 flex justify-center gap-2 text-stone-400 text-sm">
                   <span className="flex items-center gap-1"><Icons.BookOpen className="w-3 h-3"/> èª å¯¦</span>
                   <span>â€¢</span>
                   <span className="flex items-center gap-1"><Icons.Sprout className="w-3 h-3"/> æˆé•·</span>
                </div>
              </div>
            </form>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ExamReflectionApp />);
  </script>
</body>
</html>